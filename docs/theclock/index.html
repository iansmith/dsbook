<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Lesson 1: The Clock
  #

No, not like coldplay.
Although it is a very small feature of mirabeau, we are going to walk you through
how the timer works.  We are going to cover this lesson&rsquo;s code in every detail since it is likely
the first source code of a datastar program you have seen.
Eventually this display will be in a corner of the mirabeau UI but for this lesson we&rsquo;ve
made it big and central.  That makes things easier to see, especially using
the web debugger in the browser."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><script src=https://iansmith.github.io/dsbook/js/copybutton.min.d238cbcc2329139e593fcbafacddeb7ad985f9a697d90c34931c10bc221b23bc.js integrity="sha256-0jjLzCMpE55ZP8uvrN3retmF+aaX2Qw0kxwQvCIbI7w=" defer></script><meta property="og:url" content="https://iansmith.github.io/dsbook/docs/theclock/"><meta property="og:title" content="(01) The Clock"><meta property="og:description" content="Lesson 1: The Clock # No, not like coldplay.
Although it is a very small feature of mirabeau, we are going to walk you through how the timer works. We are going to cover this lesson’s code in every detail since it is likely the first source code of a datastar program you have seen.
Eventually this display will be in a corner of the mirabeau UI but for this lesson we’ve made it big and central. That makes things easier to see, especially using the web debugger in the browser."><meta property="og:locale" content="en"><meta property="og:type" content="website"><title>(01) The Clock | </title><link rel=icon href=/dsbook/favicon.png><link rel=stylesheet href=/dsbook/css/dsbook.css><link rel=manifest href=/dsbook/manifest.json><link rel=canonical href=https://iansmith.github.io/dsbook/docs/theclock/><link rel=stylesheet href=/dsbook/book.min.434035e7885c7f5d12818bd9f111cf1a0925c6fb78382667381c3d5eda3fb4f1.css integrity="sha256-Q0A154hcf10SgYvZ8RHPGgklxvt4OCZnOBw9Xto/tPE=" crossorigin=anonymous><script defer src=/dsbook/fuse.min.js></script><script defer src=/dsbook/en.search.min.f9b89a06ea4acc525f8d4ecde1a9cb6e8f0df71edc93e3e687518fc89365631e.js integrity="sha256-+biaBupKzFJfjU7N4anLbo8N9x7ck+Pmh1GPyJNlYx4=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://iansmith.github.io/dsbook/docs/theclock/index.xml title></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/dsbook/><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/dsbook/docs/thesetup/>(00) The Setup</a><ul><li><a href=/dsbook/docs/thesetup/preface/>Preface</a></li><li><a href=/dsbook/docs/thesetup/who-should-be-reading-this-book/>Who Should Be Reading This Book</a></li><li><a href=/dsbook/docs/thesetup/enable-script/>The Enable Script</a></li><li><a href=/dsbook/docs/thesetup/tooling/>Tooling</a></li></ul></li><li><a href=/dsbook/docs/theclock/ class=active>(01) The Clock</a><ul></ul></li><li><a href=/dsbook/docs/thecountdown/>(02) The Countdown</a><ul></ul></li><li><a href=/dsbook/docs/thetemple/>(03) The Temple Of Templ</a><ul></ul></li><li><a href=/dsbook/docs/markdown/>(04) Markdown</a><ul></ul></li><li><a href=/dsbook/docs/nats/>(05) NATS Receiving</a><ul></ul></li><li><a href=/dsbook/docs/slides/>(06) NATS Sending... And Slides!</a><ul></ul></li><li><a href=/dsbook/docs/microlith/>(07) The Microlith Architecture</a><ul></ul></li><li><a href=/dsbook/docs/tests/>(08) Testing</a><ul></ul></li><li><a href=/dsbook/docs/thewatchers/>(09) The Watchers</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/dsbook/svg/menu.svg class=book-icon alt=Menu></label><h3>(01) The Clock</h3><label for=toc-control></label></div></header><article class="markdown book-article"><h1 id=lesson-1-the-clock>Lesson 1: The Clock
<a class=anchor href=#lesson-1-the-clock>#</a></h1><p>No, not <a href="https://youtu.be/d020hcWA_Wg?si=P_Sw06CeyZmhA3PM">like coldplay</a>.</p><p>Although it is a very small feature of mirabeau, we are going to walk you through
how the timer works. We are going to cover this lesson&rsquo;s code in every detail since it is likely
the first source code of a datastar program you have seen.</p><p>Eventually this display will be in a corner of the mirabeau UI but for this lesson we&rsquo;ve
made it big and central. That makes things easier to see, especially using
the web debugger in the browser.</p><p>#####: <em>Aside: I don&rsquo;t really want to get into RAF here, because it just complicates the story.</em></p><h2 id=lesson-summary>Lesson summary
<a class=anchor href=#lesson-summary>#</a></h2><p>At the end of this lesson you should be able to:</p><ul><li><p>Use the provided Taskfile to build and deploy the mirabeau program</p></li><li><p>Be able to make changes to the provided lesson files to change the html
used by the application</p></li><li><p>Be able to change some browser interactions with application:</p><ul><li>Change the data that is stored in the store to prove you understand about
manipulating the store.<ul><li>We are going to just brute force store updates with a string and <code>PatchStoreRaw()</code>.</li><li>Similarly, the store values on input will be brute forced through the normal go
json machinery. No separate type to allow the json decode, just <code>map[string]any</code>.</li></ul></li></ul></li><li><p>We need to flagellate the reader with the importance and reason that one should not try to keep
a lot of state on the client. This will be the natural thing to do (for some of us, ahem).</p></li></ul><p>At the end of this lesson should also know enough to:</p><ul><li><p>Explain to others what these mechanisms in datastar are for:</p><ul><li>Generating html content (for the moment using just strings)</li><li>Manipulating the store (again, just strings with sprintf or similar)</li><li>Responding to user input (at least the case of a mouse click)</li></ul></li><li><p>Explain to others the basics of the SSE mechanism</p><ul><li>Explain where, why and what is the long-lived http GET request in this lesson.</li><li>Explain why DS doesn&rsquo;t use websockets</li></ul></li><li><p>Bonus Points: Explain how the Taskfile works.</p></li><li><p>You may not understand all the details of these mechanisms yet, but
<strong>this is it</strong> &mldr; there really are no more to learn!</p></li></ul><h3 id=whats-the-comparison-to-react>What&rsquo;s the comparison to react?
<a class=anchor href=#whats-the-comparison-to-react>#</a></h3><ul><li>Do we know a React (or whatever) expert who understands DS enough to explain to us what
the analogies are for React?</li><li>I think it&rsquo;s a good point to take a shot at the whole redux craziness in comparison
to just using some strings of javascript.</li></ul><h3 id=exercises>Exercises
<a class=anchor href=#exercises>#</a></h3><ul><li>Instrument the code to see how many frames per second your timer is able to perform.</li></ul><h3 id=for-the-truly-gung-ho-advanced-exercises-we-dont-provide-the-answers>For the truly gung-ho (advanced exercises; we don&rsquo;t provide the answers)
<a class=anchor href=#for-the-truly-gung-ho-advanced-exercises-we-dont-provide-the-answers>#</a></h3><ul><li>Change your store to use a strinng for the current time and drive the string
from the server with <code>PatchStore</code>. Once you do this, change the string
to display to be binary, hex, or octal, which ever one you like the most.</li><li>Linux: Use the <code>/proc/loadaverage</code> interface to estimate what the maximum number
of clients your local machine could support at its current framework. Interpreting
the information you get <code>/proc/loadaverage</code> can be tricky&mldr; watch out for
multiple CPUs!</li></ul><h5 id=_-aside-i-want-to-start-cutting-off-performance-questions-as-soon-as-possible_>_ Aside: I want to start cutting off performance questions as soon as possible._
<a class=anchor href=#_-aside-i-want-to-start-cutting-off-performance-questions-as-soon-as-possible_>#</a></h5></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/iansmith/dsbook/commit/d6a544f900883f26bf0c40c1d24535767f6fb2ce title='Last modified by Ian Smith | October 30, 2024' target=_blank rel=noopener><img src=/dsbook/svg/calendar.svg class=book-icon alt>
<span>October 30, 2024</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>